---
title: "Vignette Title"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The `html_vignette` output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style

## Example

```{r, eval = FALSE}

data(iris)

library(ggplot2)
library(drewcurves)
library(andrews)
library(tidyr)
library(dplyr)

## Trying to do everything withing a function

drewcurves <- function (df, type = 1, clr = NULL, resolution = 100, minmax_scaling = TRUE) {
  
}

str(iris)

iris[, names(iris)[5]]
head(iris[, "Species"])

select(iris, Species)

## ------------------------------------------

X <- iris[, -5]
Y <- apply(X, 2, function(x) (x - min(x))/(max(x) - min(x)))
t <- seq(-pi, pi, len = 100)
group <- iris$Species

minmax1 <- function(X) {
  apply(X, 2, function (x) (x - min(x))/(max(x) - min(x)))
}

minmax2 <- function(X) {
  apply(X, 2, function (x) {
    minx <- min(x)
    maxx <- max(x)
    range <- maxx - minx
    (x - minx)/range
    })
}
  
minmax3 <- function(X) {
  f_temp <- function(x) {
    b <- min(x)
    c <- max(x) - b
    (x - b)/c
  }
  mutate_all(X, f_temp)
}

minmax4 <- function(X) {
  colmin <- apply(X, 2, min)
  colmax <- apply(X, 2, max)
  colrange <- colmax - colmin
  sweep(sweep(X, 2, colmin), 2, colrange, "/")
}

minmax5 <- function(X) {
  X <- as.matrix(X)
  colmin <- colMins(X)
  colmax <- colMaxs(X)
  colrange <- colmax - colmin
  sweep(sweep(X, 2, colmin), 2, colrange, "/")
}

library(matrixStats)

head(Y)  
head(minmax_normalization(W))  
head(minmax1(W))  
head(minmax2(W))  
head(minmax3(W))  
head(minmax4(W))  
head(minmax5(W))  

summary(minmax3(W))  
summary(minmax3(Y))  

rbenchmark::benchmark(
  head(minmax_normalization(W)),  
  head(minmax1(W)),  
  head(minmax2(W)),  
  head(minmax3(W)),  
  head(minmax4(W)),  
  head(minmax5(W))  
)


andrews(iris, clr = 5, ymax = 2.5)


Z <- compute_fourier_series(Y, t, 1)

Z %>%
  as.data.frame() %>%
  # tbl_df() %>%
  mutate(t = t) %>%
  gather(key, value, -t) %>%
  mutate(group = rep(group, each = nrow(Z))) %>%
  ggplot(aes(t, value, group = key)) + 
  geom_line(aes(color = group))
  

dim(Z)



```

